{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\kesav\\\\Downloads\\\\TheShoeShop-main\\\\TheShoeShop-main\\\\frontend\\\\src\\\\components\\\\Products\\\\Products.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useState, useEffect, useCallback } from \"react\";\nimport { MyContext } from \"../../Context/Context\";\nimport FilterProducts from \"./FilterProducts\";\nimport Product from \"./Product\";\nimport SortBy from \"./SortBy\";\nimport { useLocation } from \"react-router-dom\";\nimport { Paper, CircularProgress } from \"@material-ui/core/\";\nimport ReactPaginate from \"react-paginate\";\nimport \"./paginate.css\";\nconst windowCheck = window.screen.width;\nexport const Products = () => {\n  _s();\n\n  const {\n    state\n  } = useContext(MyContext);\n  const params = useLocation();\n  const [products, setProducts] = useState(state.products);\n  const [activeFilter, setActiveFilter] = useState([]);\n  useEffect(() => {\n    setProducts(state.products);\n\n    if (params.state === \"men\" || params.state === \"women\" || params.state === \"all\") {\n      setValue(params.state);\n    } else {\n      setValue(\"all\");\n    }\n  }, [state.products, params, state]);\n\n  const onFilterChange = filter => {\n    if (filter === \"All\") {\n      setActiveFilter([]);\n    } else {\n      if (activeFilter.includes(filter)) {\n        const filterIndex = activeFilter.indexOf(filter);\n        const newFilter = [...activeFilter];\n        newFilter.splice(filterIndex, 1);\n        setActiveFilter(newFilter);\n      } else {\n        setActiveFilter([...activeFilter, filter]);\n      }\n    }\n  };\n\n  const [value, setValue] = useState(\"all\");\n  const [numberz, setNumberz] = useState([]);\n\n  const handleChange = event => {\n    setValue(event.target.value);\n    setActiveFilter([]);\n  };\n\n  useEffect(() => {\n    if (!activeFilter.length) {\n      if (value === \"all\") {\n        setProducts(state.products);\n        setNumberz(state.products);\n        setSort(\"\");\n      } else if (value === \"men\") {\n        const findMen = state.products.filter(el => el.category.toLowerCase() === \"men\");\n        setProducts(findMen);\n        setNumberz(findMen);\n        setSort(\"\");\n      } else if (value === \"women\") {\n        const findWomen = state.products.filter(el => el.category.toLowerCase() === \"women\");\n        setProducts(findWomen);\n        setNumberz(findWomen);\n        setSort(\"\");\n      }\n    } else {\n      const copy = [...state.products];\n      const filter = copy.filter(item => activeFilter.includes(item.color.toLowerCase()) || activeFilter.includes(item.brand.toLowerCase()));\n      const combine = copy.filter(item => activeFilter.includes(item.color.toLowerCase()) && activeFilter.includes(item.brand.toLowerCase()));\n\n      if (combine.length) {\n        if (value === \"all\") {\n          setProducts(combine);\n        } else {\n          const combineZ = combine.filter(el => el.category.toLowerCase() === value);\n          setProducts(combineZ);\n        }\n      } else {\n        if (value === \"all\") {\n          setProducts(filter);\n        } else {\n          const filterZ = filter.filter(el => el.category.toLowerCase() === value);\n          setProducts(filterZ);\n        }\n      }\n    }\n  }, [activeFilter, value, state]);\n  const [sort, setSort] = useState(\"\");\n\n  const handleChangeSort = event => {\n    setSort(event.target.value);\n    sortItems(event.target.value);\n  };\n\n  const calculate = product => {\n    if (!product.reviews.length) {\n      return 0;\n    } else if (product.reviews.length === 1) {\n      return product.reviews[0].rating;\n    } else {\n      const calculate = product.reviews.reduce((a, b) => {\n        return (a.rating + b.rating) / product.reviews.length;\n      });\n      return calculate;\n    }\n  };\n\n  const sortItems = useCallback(value => {\n    const copy = [...products];\n\n    if (value === \"Cheapest first\") {\n      const sortCheap = copy.sort((a, b) => a.price - b.price);\n      setProducts(sortCheap);\n    } else if (value === \"Expensive first\") {\n      const sortExpensive = copy.sort((a, b) => a.price - b.price).reverse();\n      setProducts(sortExpensive);\n    } else if (value === \"Highest rating\") {\n      const map = copy.sort((a, b) => {\n        return calculate(a) - calculate(b);\n      }).reverse();\n      setProducts(map);\n    } else if (value === \"Lowest rating\") {\n      const map = copy.sort((a, b) => {\n        return calculate(a) - calculate(b);\n      });\n      setProducts(map);\n    }\n  }, [products]); ///Pagination\n\n  const [pageCount, setpageCount] = useState(3);\n  const [perPage, setperPage] = useState(10);\n  const [offset, setoffset] = useState(0);\n\n  const handlePageClick = data => {\n    let selected = data.selected;\n    let offset = Math.ceil(selected * perPage);\n    setoffset(offset);\n  };\n\n  useEffect(() => {\n    setperPage(10);\n    setoffset(0);\n  }, [value]);\n  useEffect(() => {\n    setpageCount(Math.ceil(products.length / perPage));\n  }, [perPage, products.length, value]);\n\n  if (!state.products) {\n    return /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: [\" \", /*#__PURE__*/_jsxDEV(CircularProgress, {\n        color: \"secondary\",\n        style: {\n          color: \"orange\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }, this), \"Loading...\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 7\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: \"flex\",\n      flexDirection: \"column\",\n      width: \"100%\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(SortBy, {\n      products: products,\n      handleChangeSort: handleChangeSort,\n      sort: sort\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\",\n        flexDirection: windowCheck <= 768 ? \"column\" : \"row\",\n        width: \"100%\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(FilterProducts, {\n        onFilterChange: onFilterChange,\n        activeFilter: activeFilter,\n        handleChange: handleChange,\n        products: numberz,\n        value: value\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\",\n          flexDirection: \"row\",\n          flexWrap: \"wrap\",\n          flex: \"1 1 0\",\n          justifyContent: \"flex-start\",\n          width: \"100%\",\n          margin: \"0 auto\"\n        },\n        children: products.slice(offset, offset + perPage).map((item, index) => {\n          return /*#__PURE__*/_jsxDEV(Product, {\n            product: item\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 20\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Paper, {\n      elevation: 1,\n      style: {\n        width: \"100%\",\n        float: \"right\"\n      },\n      children: /*#__PURE__*/_jsxDEV(ReactPaginate, {\n        previousLabel: \"<\",\n        nextLabel: \">\",\n        breakLabel: \"...\",\n        breakClassName: \"break-me\",\n        pageCount: pageCount,\n        marginPagesDisplayed: 2,\n        pageRangeDisplayed: 5,\n        onPageChange: handlePageClick,\n        containerClassName: \"pagination\",\n        subContainerClassName: \"pages pagination\",\n        activeClassName: \"active\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 184,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Products, \"H+6zKsDoNfVXYoEjDRwKt6jSnGc=\", false, function () {\n  return [useLocation];\n});\n\n_c = Products;\nexport default Products;\n\nvar _c;\n\n$RefreshReg$(_c, \"Products\");","map":{"version":3,"sources":["C:/Users/kesav/Downloads/TheShoeShop-main/TheShoeShop-main/frontend/src/components/Products/Products.js"],"names":["React","useContext","useState","useEffect","useCallback","MyContext","FilterProducts","Product","SortBy","useLocation","Paper","CircularProgress","ReactPaginate","windowCheck","window","screen","width","Products","state","params","products","setProducts","activeFilter","setActiveFilter","setValue","onFilterChange","filter","includes","filterIndex","indexOf","newFilter","splice","value","numberz","setNumberz","handleChange","event","target","length","setSort","findMen","el","category","toLowerCase","findWomen","copy","item","color","brand","combine","combineZ","filterZ","sort","handleChangeSort","sortItems","calculate","product","reviews","rating","reduce","a","b","sortCheap","price","sortExpensive","reverse","map","pageCount","setpageCount","perPage","setperPage","offset","setoffset","handlePageClick","data","selected","Math","ceil","display","flexDirection","flexWrap","flex","justifyContent","margin","slice","index","float"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect, useCallback } from \"react\";\nimport { MyContext } from \"../../Context/Context\";\nimport FilterProducts from \"./FilterProducts\";\nimport Product from \"./Product\";\nimport SortBy from \"./SortBy\";\nimport { useLocation } from \"react-router-dom\";\nimport { Paper, CircularProgress } from \"@material-ui/core/\";\nimport ReactPaginate from \"react-paginate\";\nimport \"./paginate.css\";\nconst windowCheck = window.screen.width;\nexport const Products = () => {\n  const { state } = useContext(MyContext);\n  const params = useLocation();\n\n  const [products, setProducts] = useState(state.products);\n  const [activeFilter, setActiveFilter] = useState([]);\n\n  useEffect(() => {\n    setProducts(state.products);\n\n    if (\n      params.state === \"men\" ||\n      params.state === \"women\" ||\n      params.state === \"all\"\n    ) {\n      setValue(params.state);\n    } else {\n      setValue(\"all\");\n    }\n  }, [state.products, params, state]);\n\n  const onFilterChange = (filter) => {\n    if (filter === \"All\") {\n      setActiveFilter([]);\n    } else {\n      if (activeFilter.includes(filter)) {\n        const filterIndex = activeFilter.indexOf(filter);\n        const newFilter = [...activeFilter];\n        newFilter.splice(filterIndex, 1);\n        setActiveFilter(newFilter);\n      } else {\n        setActiveFilter([...activeFilter, filter]);\n      }\n    }\n  };\n  const [value, setValue] = useState(\"all\");\n  const [numberz, setNumberz] = useState([]);\n  const handleChange = (event) => {\n    setValue(event.target.value);\n    setActiveFilter([]);\n  };\n\n  useEffect(() => {\n    if (!activeFilter.length) {\n      if (value === \"all\") {\n        setProducts(state.products);\n        setNumberz(state.products);\n        setSort(\"\");\n      } else if (value === \"men\") {\n        const findMen = state.products.filter(\n          (el) => el.category.toLowerCase() === \"men\"\n        );\n        setProducts(findMen);\n        setNumberz(findMen);\n        setSort(\"\");\n      } else if (value === \"women\") {\n        const findWomen = state.products.filter(\n          (el) => el.category.toLowerCase() === \"women\"\n        );\n        setProducts(findWomen);\n        setNumberz(findWomen);\n        setSort(\"\");\n      }\n    } else {\n      const copy = [...state.products];\n      const filter = copy.filter(\n        (item) =>\n          activeFilter.includes(item.color.toLowerCase()) ||\n          activeFilter.includes(item.brand.toLowerCase())\n      );\n\n      const combine = copy.filter(\n        (item) =>\n          activeFilter.includes(item.color.toLowerCase()) &&\n          activeFilter.includes(item.brand.toLowerCase())\n      );\n\n      if (combine.length) {\n        if (value === \"all\") {\n          setProducts(combine);\n        } else {\n          const combineZ = combine.filter(\n            (el) => el.category.toLowerCase() === value\n          );\n          setProducts(combineZ);\n        }\n      } else {\n        if (value === \"all\") {\n          setProducts(filter);\n        } else {\n          const filterZ = filter.filter(\n            (el) => el.category.toLowerCase() === value\n          );\n          setProducts(filterZ);\n        }\n      }\n    }\n  }, [activeFilter, value, state]);\n\n  const [sort, setSort] = useState(\"\");\n\n  const handleChangeSort = (event) => {\n    setSort(event.target.value);\n    sortItems(event.target.value);\n  };\n\n  const calculate = (product) => {\n    if (!product.reviews.length) {\n      return 0;\n    } else if (product.reviews.length === 1) {\n      return product.reviews[0].rating;\n    } else {\n      const calculate = product.reviews.reduce((a, b) => {\n        return (a.rating + b.rating) / product.reviews.length;\n      });\n      return calculate;\n    }\n  };\n\n  const sortItems = useCallback(\n    (value) => {\n      const copy = [...products];\n      if (value === \"Cheapest first\") {\n        const sortCheap = copy.sort((a, b) => a.price - b.price);\n        setProducts(sortCheap);\n      } else if (value === \"Expensive first\") {\n        const sortExpensive = copy.sort((a, b) => a.price - b.price).reverse();\n        setProducts(sortExpensive);\n      } else if (value === \"Highest rating\") {\n        const map = copy\n          .sort((a, b) => {\n            return calculate(a) - calculate(b);\n          })\n          .reverse();\n        setProducts(map);\n      } else if (value === \"Lowest rating\") {\n        const map = copy.sort((a, b) => {\n          return calculate(a) - calculate(b);\n        });\n\n        setProducts(map);\n      }\n    },\n    [products]\n  );\n  ///Pagination\n  const [pageCount, setpageCount] = useState(3);\n  const [perPage, setperPage] = useState(10);\n  const [offset, setoffset] = useState(0);\n\n  const handlePageClick = (data) => {\n    let selected = data.selected;\n    let offset = Math.ceil(selected * perPage);\n\n    setoffset(offset);\n  };\n  useEffect(() => {\n    setperPage(10);\n    setoffset(0);\n  }, [value]);\n  useEffect(() => {\n    setpageCount(Math.ceil(products.length / perPage));\n  }, [perPage, products.length, value]);\n  if (!state.products) {\n    return (\n      <h1>\n        {\" \"}\n        <CircularProgress color=\"secondary\" style={{ color: \"orange\" }} />\n        Loading...\n      </h1>\n    );\n  }\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        width: \"100%\",\n      }}\n    >\n      <SortBy\n        products={products}\n        handleChangeSort={handleChangeSort}\n        sort={sort}\n      />\n      <div\n        style={{\n          display: \"flex\",\n\n          flexDirection: windowCheck <= 768 ? \"column\" : \"row\",\n          width: \"100%\",\n        }}\n      >\n        <FilterProducts\n          onFilterChange={onFilterChange}\n          activeFilter={activeFilter}\n          handleChange={handleChange}\n          products={numberz}\n          value={value}\n        />\n\n        <div\n          style={{\n            display: \"flex\",\n            flexDirection: \"row\",\n            flexWrap: \"wrap\",\n\n            flex: \"1 1 0\",\n            justifyContent: \"flex-start\",\n            width: \"100%\",\n            margin: \"0 auto\",\n          }}\n        >\n          {products.slice(offset, offset + perPage).map((item, index) => {\n            return <Product product={item} key={index} />;\n          })}\n        </div>\n      </div>\n      <Paper elevation={1} style={{ width: \"100%\", float: \"right\" }}>\n        <ReactPaginate\n          previousLabel={\"<\"}\n          nextLabel={\">\"}\n          breakLabel={\"...\"}\n          breakClassName={\"break-me\"}\n          pageCount={pageCount}\n          marginPagesDisplayed={2}\n          pageRangeDisplayed={5}\n          onPageChange={handlePageClick}\n          containerClassName={\"pagination\"}\n          subContainerClassName={\"pages pagination\"}\n          activeClassName={\"active\"}\n        />\n      </Paper>\n    </div>\n  );\n};\nexport default Products;\n"]},"metadata":{},"sourceType":"module"}